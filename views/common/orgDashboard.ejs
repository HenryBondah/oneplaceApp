<main>
    <div class="dashboard-container">
        <div class="classes-container">
            <h2>Classes</h2>
            <ul>
                <% if (classes && classes.length > 0) { %>
                    <% classes.forEach(function(cls) { %>
                        <li><a href="/common/classDashboard?classId=<%= cls.class_id %>"><%= cls.class_name %></a></li>
                    <% }); %>
                <% } else { %>
                    <li>No classes found</li>
                <% } %>
            </ul>
        </div>

        <div class="info-grid">
            <div class="calendar-container">
                <h2>Today's Date and Time</h2>
                <div class="date" id="currentDate"></div>
                <div class="time" id="currentTime"></div>
            </div>

            <div class="school-year-info">
                <% if (schoolYear) { %>
                    <h2>Current School Year: <%= schoolYear.year_label %></h2>
                    <% if (currentTerm) { %>
                        <div>
                            <strong><%= currentTerm.term_name %>:</strong>
                            Start: <%= new Date(currentTerm.start_date).toISOString().split('T')[0] %>,
                            End: <%= new Date(currentTerm.end_date).toISOString().split('T')[0] %>
                            <div class="countdown" data-start-date="<%= currentTerm.start_date.toISOString() %>" data-end-date="<%= currentTerm.end_date.toISOString() %>" data-term-name="<%= currentTerm.term_name %>"></div>
                        </div>
                        <div>
                            <strong>Days until end of term: </strong>
                            <span id="daysUntilEnd"><%= Math.ceil((new Date(currentTerm.end_date) - new Date()) / (1000 * 60 * 60 * 24)) %></span>
                        </div>
                    <% } else { %>
                        <p>No current term information available.</p>
                    <% } %>
                <% } else { %>
                    <div class="school-year-info">
                        <h2>No current school year information available.</h2>
                    </div>
                <% } %>
            </div>
        </div>
    </div>

    <h2>Events</h2>
    <ul>
        <% if (events && events.length > 0) { %>
            <% events.forEach(function(event) { %>
                <li><strong><%= event.name %></strong> - <%= new Date(event.event_date).toISOString().split('T')[0] %><br><%= event.details %></li>
            <% }); %>
        <% } else { %>
            <li>No events found</li>
        <% } %>
    </ul>

    <h2>Announcements</h2>
    <ul>
        <% if (announcements && announcements.length > 0) { %>
            <% announcements.forEach(function(announcement) { %>
                <li><%= announcement.message %></li>
            <% }); %>
        <% } else { %>
            <li>No announcements found</li>
        <% } %>
    </ul>
</main>
<script src="/js/orgDashboard.js"></script>
