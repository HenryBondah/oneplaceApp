<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Attendance Records for <%= className %></title>
    <link rel="stylesheet" href="/styles/main.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>Attendance Records for <%= className %></h1>
    <button class="edit-button">Edit</button>
    <div class="attendance-table-container">
        <table>
            <thead>
                <tr>
                    <th>Student Name</th>
                    <% dates.forEach(date => { %>
                        <th>
                            <%= date %><br>
                            <a href="#" class="save-link">Save</a><br>
                            <span class="timestamp"><%= attendanceMap[students[0].student_id] && attendanceMap[students[0].student_id][date] ? attendanceMap[students[0].student_id][date].timestamp : '' %></span>
                        </th>
                    <% }); %>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                <% students.forEach(student => {
                    let presentCount = 0;
                %>
                    <tr>
                        <td><%= student.first_name %> <%= student.last_name %></td>
                        <% dates.forEach(date => {
                            const isPresent = attendanceMap[student.student_id] && attendanceMap[student.student_id][date] && attendanceMap[student.student_id][date].status === 'Present';
                            if (isPresent) presentCount++;
                        %>
                            <td>
                                <input type="checkbox" data-student-id="<%= student.student_id %>" data-date="<%= date %>" <%= isPresent ? 'checked' : '' %> disabled>
                            </td>
                        <% }); %>
                        <td><%= presentCount %> / <%= dates.length %></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    </div>
</body>
</html>
