<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mark Attendance for <%= className %></title>
    <link rel="stylesheet" href="/styles/main.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>Mark Attendance for <%= className %></h1>
    <button class="edit-button">Edit</button>
    <div class="attendance-table-container">
        <table>
            <thead>
                <tr>
                    <th>Student Name</th>
                    <% dates.forEach(date => { %>
                        <th>
                            <%= new Date(date).toLocaleDateString() %><br>
                            <a href="#" class="save-link">Save</a><br>
                            <span class="timestamp"><%= attendanceMap[students[0].student_id] && attendanceMap[students[0].student_id][date] ? new Date(attendanceMap[students[0].student_id][date].marked_at).toLocaleString() : '' %></span>
                        </th>
                    <% }); %>
                </tr>
            </thead>
            <tbody>
                <% students.forEach(student => { %>
                    <tr>
                        <td><%= student.first_name %> <%= student.last_name %></td>
                        <% dates.forEach(date => {
                            const isPresent = attendanceMap[student.student_id] && attendanceMap[student.student_id][date] && attendanceMap[student.student_id][date].status === 'Present';
                        %>
                            <td>
                                <input type="checkbox" data-student-id="<%= student.student_id %>" data-date="<%= date %>" <%= isPresent ? 'checked' : '' %> disabled>
                            </td>
                        <% }); %>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    </div>
</body>
</html>
